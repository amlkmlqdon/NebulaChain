Refactor access control for session (complex)
